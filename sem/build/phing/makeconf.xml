<project name="makeconf" basedir="." default="-makeconf"
	description="make all config files">

	<target name="-makeconf" description="Make all config files">
		<phingcall target="-cleanup" />
		<phingcall target="-dev" />
		<phingcall target="-unittest" />
	</target>

	<target name="-cleanup" description="delete old config files.">
		<phingcall target="-cleanup-dev" />
		<phingcall target="-cleanup-unittest" />
	</target>

	<target name="-cleanup-dev" description="Delete all config files.">
		<delete>
			<fileset dir="config/">
				<include name="*.ini" />
			</fileset>
		</delete>
	</target>

	<target name="-cleanup-unittest" description="Delete all config files.">
		<delete>
			<fileset dir="test/unit/ini/">
				<include name="*.ini" />
			</fileset>
		</delete>
	</target>

	<target name="-dev" description="Make configure files for development">
		<phingcall target="-cleanup-dev" />
		<copy file="build/tpl/global.ini" todir="config" overwrite="true">
			<filterchain>
				<replacetokens begintoken="##" endtoken="##">
					<token key="dir.root" value="${dir.root}" />
				</replacetokens>
			</filterchain>
		</copy>

		<copy file="build/tpl/mysql.ini" todir="config" overwrite="true">
			<filterchain>
				<replacetokens begintoken="##" endtoken="##">
					<token key="mysql.master.server1" value="mysql://db_write:123456@edp.corp.alimama.com:9901" />
					<token key="mysql.slave.server1" value="mysql://db_read:123456@edp.corp.alimama.com:9901" />
				</replacetokens>
			</filterchain>
		</copy>
	</target>

	<target name="-unittest" description="Make configure files for unit test.">
		<phingcall target="-cleanup-unittest" />
	</target>
</project>
